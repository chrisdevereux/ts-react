machine:
  node:
    version: 6.3.1

  pre:
    - curl -k -L -o phantomjs.tar.bz2 https://bitbucket.org/ariya/phantomjs/downloads/phantomjs-2.1.1-linux-x86_64.tar.bz2
    - tar -jxf phantomjs.tar.bz2

test:
  override:
    - "npm run test:ci":
        environment:
          MOCHA_FILE: $CIRCLE_TEST_REPORTS/junit/test-results.xml

    - "npm run ui-test":
        environment:
          UI_TEST_ENV: CI
          NODE_ENV: production

deployment:
  staging:
    branch: master
    heroku:
      appname: ts-react-staging
